<!DOCTYPE html>
<html>
<head>
    <title>Autoware Remote Control</title>
</head>
<body>
    <h1>Autoware Remote Control</h1>
    <button id="engageButton">AUTO</button>
    <button id="disengageButton">STOP</button>
    <div id="status">Connecting...</div>

    <script src="https://cdn.jsdelivr.net/npm/roslib@1/build/roslib.min.js"></script>
    <script>
        // â¬‡ï¸ ì—¬ê¸° IP ì£¼ì†Œê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!
        const rosbridge_url = 'ws://34.64.221.18:9090';

        // ROS ì—°ê²° ì„¤ì •
        const ros = new ROSLIB.Ros({
            url: rosbridge_url
        });

        // ì—°ê²° ìƒíƒœ í‘œì‹œ
        const statusDiv = document.getElementById('status');
        ros.on('connection', function() {
            console.log('Connected to websocket server.');
            statusDiv.innerHTML = 'âœ… Connected';
        });
        ros.on('error', function(error) {
            console.log('Error connecting to websocket server: ', error);
            statusDiv.innerHTML = 'âŒ Error';
        });
        ros.on('close', function() {
            console.log('Connection to websocket server closed.');
            statusDiv.innerHTML = 'ğŸ”Œ Closed';
        });

        // Autoware engage í† í”½ ì„¤ì •
        // Autoware ë²„ì „ì— ë”°ë¼ í† í”½ ì´ë¦„ê³¼ ë©”ì‹œì§€ íƒ€ì…ì´ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        const engageTopic = new ROSLIB.Topic({
            ros: ros,
            name: '/api/autoware/set/engage', // Autoware API engage í† í”½
            messageType: 'tier4_autoware_api_msgs/msg/Engage'
        });

        // 'AUTO' ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
        document.getElementById('engageButton').onclick = function() {
            const engageMsg = new ROSLIB.Message({
                stamp: { sec: 0, nanosec: 0 },
                engage: true
            });
            engageTopic.publish(engageMsg);
            console.log('Published engage: true');
            alert('Sent AUTO command!');
        };

        // 'STOP' ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
        document.getElementById('disengageButton').onclick = function() {
            const engageMsg = new ROSLIB.Message({
                stamp: { sec: 0, nanosec: 0 },
                engage: false
            });
            engageTopic.publish(engageMsg);
            console.log('Published engage: false');
            alert('Sent STOP command!');
        };

    </script>
</body>
</html>
